= 合成复用原则

== 基本介绍

合成复用原则（Composite Reuse Principle, CRP）又叫组合/聚合复用原则（Composition/Aggregate Reuse Principle, CARP）。它要求在软件复用时，要尽量先使用组合或者聚合等关联关系来实现，其次才考虑使用继承关系来实现。

如果要使用继承关系，则必须严格遵循里氏替换原则。合成复用原则和里氏替换原则相辅相成，两者都是开闭原则的具体实现规范。

== 优缺点

一般来说，类的复用分为继承复用和组合复用两种

=== 继承复用

继承复用会将父类的实现细节暴露给子类，父类对子类是透明的，所以这种复用又称为“白箱复用”

继承复用虽然简单且容易实现，但是它也有如下缺点：

. 继承复用破坏了类的封装性
. 子类与父类的耦合度高。父类的任何变化都会导致子类的实现发生变化，这就不利于扩展与维护
. 限制了复用的灵活性。从父类继承而来的实现是静态的，在编译时就已经确定，在运行时不可能发生变化

=== 组合/聚合复用

组合复用一般将已有对象纳入新对象中，使之成为新对象的一部分，新对象可以调用已有对象的功能，因为成分对象的内部细节是新对象看不见的，所以这种复用又称为“黑箱复用”

组合复用有如下优点：

. 组合复用维持了类的封装性
. 新旧类之间的耦合度低。这种复用所需的依赖较少，新对象存取成分对象唯一方式是通过成分对象的接口
. 复用的灵活性更高。这种复用可以在运行时动态进行，新对象可以动态的引用成分对象类型相同的对象